//
//  LunarGre.c
//  BaZi
//
//  Created by ms on 2017/6/5.
//  Copyright © 2017年 ms. All rights reserved.
//

#include "LunarGre.h"
#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

// 1890 ~ 2100 年农历新年数据
static int springFestival[][211] = {{1,21},{2,9},{1,30},{2,17},{2,6},{1,26},{2,14},{2,2},{1,22},{2,10},
    {1,31},{2,19},{2,8},{1,29},{2,16},{2,4},{1,25},{2,13},{2,2},{1,22},{2,10},{1,30},{2,18},{2,6},{1,26},{2,14},{2,4},{1,23},{2,11},{2,1},{2,20},{2,8},{1,28},{2,16},{2,5},{1,24},{2,13},{2,2},{1,23},{2,10},{1,30},{2,17},{2,6},{1,26},{2,14},{2,4},{1,24},{2,11},{1,31},{2,19},{2,8},{1,27},{2,15},{2,5},{1,25},{2,13},{2,2},{1,22},{2,10},{1,29},{2,17},{2,6},{1,27},{2,14},{2,3},{1,24},{2,12},{1,31},{2,18},{2,8},{1,28},{2,15},{2,5},{1,25},{2,13},{2,2},{1,21},{2,9},{1,30},{2,17},{2,6},{1,27},{2,15},{2,3},{1,23},{2,11},{1,31},{2,18},{2,7},{1,28},{2,16},{2,5},{1,25},{2,13},{2,2},{2,20},{2,9},{1,29},{2,17},{2,6},{1,27},{2,15},{2,4},{1,23},{2,10},{1,31},{2,19},{2,7},{1,28},{2,16},{2,5},{1,24},{2,12},{2,1},{1,22},{2,9},{1,29},{2,18},{2,7},{1,26},{2,14},{2,3},{1,23},{2,10},{1,31},{2,19},{2,8},{1,28},{2,16},{2,5},{1,25},{2,12},{2,1},{1,22},{2,10},{1,29},{2,17},{2,6},{1,26},{2,13},{2,3},{1,23},{2,11},{1,31},{2,19},{2,8},{1,28},{2,15},{2,4},{1,24},{2,12},{2,1},{1,22},{2,10},{1,30},{2,17},{2,6},{1,26},{2,14},{2,2},{1,23},{2,11},{2,1},{2,19},{2,8},{1,28},{2,15},{2,4},{1,24},{2,12},{2,2},{1,21},{2,9},{1,29},{2,17},{2,5},{1,26},{2,14},{2,3},{1,23},{2,11},{1,31},{2,19},{2,7},{1,27},{2,15},{2,5},{1,24},{2,12},{2,2},{1,22},{2,9},{1,29},{2,17},{2,6},{1,26},{2,14},{2,3},{1,24},{2,10},{1,30},{2,18},{2,7},{1,27},{2,15},{2,5},{1,25},{2,12},{2,1},{1,21},{2,9}};

/**
 * 1890 - 2100 年的农历数据
 * 数据格式：[0,2,9,21936]
 * [闰月所在月，0为没有闰月; *正月初一对应公历月; *正月初一对应公历日; *农历每月的天数的数组（需转换为二进制,得到每月大小，0=小月(29日),1=大月(30日)）;]
	*/
static int lunarInfo[][210] = {{2,1,21,22184},{0,2,9,21936},{6,1,30,9656},{0,2,17,9584},{0,2,6,21168},{5,1,26,43344},{0,2,13,59728},{0,2,2,27296},{3,1,22,44368},{0,2,10,43856},{8,1,30,19304},{0,2,19,19168},{0,2,8,42352},{5,1,29,21096},{0,2,16,53856},{0,2,4,55632},{4,1,25,27304},{0,2,13,22176},{0,2,2,39632},{2,1,22,19176},{0,2,10,19168},{6,1,30,42200},{0,2,18,42192},{0,2,6,53840},{5,1,26,54568},{0,2,14,46400},{0,2,3,54944},{2,1,23,38608},{0,2,11,38320},{7,2,1,18872},{0,2,20,18800},{0,2,8,42160},{5,1,28,45656},{0,2,16,27216},{0,2,5,27968},{4,1,24,44456},{0,2,13,11104},{0,2,2,38256},{2,1,23,18808},{0,2,10,18800},{6,1,30,25776},{0,2,17,54432},{0,2,6,59984},{5,1,26,27976},{0,2,14,23248},{0,2,4,11104},{3,1,24,37744},{0,2,11,37600},{7,1,31,51560},{0,2,19,51536},{0,2,8,54432},{6,1,27,55888},{0,2,15,46416},{0,2,5,22176},{4,1,25,43736},{0,2,13,9680},{0,2,2,37584},{2,1,22,51544},{0,2,10,43344},{7,1,29,46248},{0,2,17,27808},{0,2,6,46416},{5,1,27,21928},{0,2,14,19872},{0,2,3,42416},{3,1,24,21176},{0,2,12,21168},{8,1,31,43344},{0,2,18,59728},{0,2,8,27296},{6,1,28,44368},{0,2,15,43856},{0,2,5,19296},{4,1,25,42352},{0,2,13,42352},{0,2,2,21088},{3,1,21,59696},{0,2,9,55632},{7,1,30,23208},{0,2,17,22176},{0,2,6,38608},{5,1,27,19176},{0,2,15,19152},{0,2,3,42192},{4,1,23,53864},{0,2,11,53840},{8,1,31,54568},{0,2,18,46400},{0,2,7,46752},{6,1,28,38608},{0,2,16,38320},{0,2,5,18864},{4,1,25,42168},{0,2,13,42160},{10,2,2,45656},{0,2,20,27216},{0,2,9,27968},{6,1,29,44448},{0,2,17,43872},{0,2,6,38256},{5,1,27,18808},{0,2,15,18800},{0,2,4,25776},{3,1,23,27216},{0,2,10,59984},{8,1,31,27432},{0,2,19,23232},{0,2,7,43872},{5,1,28,37736},{0,2,16,37600},{0,2,5,51552},{4,1,24,54440},{0,2,12,54432},{0,2,1,55888},{2,1,22,23208},{0,2,9,22176},{7,1,29,43736},{0,2,18,9680},{0,2,7,37584},{5,1,26,51544},{0,2,14,43344},{0,2,3,46240},{4,1,23,46416},{0,2,10,44368},{9,1,31,21928},{0,2,19,19360},{0,2,8,42416},{6,1,28,21176},{0,2,16,21168},{0,2,5,43312},{4,1,25,29864},{0,2,12,27296},{0,2,1,44368},{2,1,22,19880},{0,2,10,19296},{6,1,29,42352},{0,2,17,42208},{0,2,6,53856},{5,1,26,59696},{0,2,13,54576},{0,2,3,23200},{3,1,23,27472},{0,2,11,38608},{11,1,31,19176},{0,2,19,19152},{0,2,8,42192},{6,1,28,53848},{0,2,15,53840},{0,2,4,54560},{5,1,24,55968},{0,2,12,46496},{0,2,1,22224},{2,1,22,19160},{0,2,10,18864},{7,1,30,42168},{0,2,17,42160},{0,2,6,43600},{5,1,26,46376},{0,2,14,27936},{0,2,2,44448},{3,1,23,21936},{0,2,11,37744},{8,2,1,18808},{0,2,19,18800},{0,2,8,25776},{6,1,28,27216},{0,2,15,59984},{0,2,4,27424},{4,1,24,43872},{0,2,12,43744},{0,2,2,37600},{3,1,21,51568},{0,2,9,51552},{7,1,29,54440},{0,2,17,54432},{0,2,5,55888},{5,1,26,23208},{0,2,14,22176},{0,2,3,42704},{4,1,23,21224},{0,2,11,21200},{8,1,31,43352},{0,2,19,43344},{0,2,7,46240},{6,1,27,46416},{0,2,15,44368},{0,2,5,21920},{4,1,24,42448},{0,2,12,42416},{0,2,2,21168},{3,1,22,43320},{0,2,9,26928},{7,1,29,29336},{0,2,17,27296},{0,2,6,44368},{5,1,26,19880},{0,2,14,19296},{0,2,3,42352},{4,1,24,21104},{0,2,10,53856},{8,1,30,59696},{0,2,18,54560},{0,2,7,55968},{6,1,27,27472},{0,2,15,22224},{0,2,5,19168},{4,1,25,42216},{0,2,12,42192},{0,2,1,53584},{2,1,21,55592},{0,2,9,54560}};

char *zodiac[] = {"鼠", "牛", "虎", "兔", "龙", "蛇", "马", "羊", "猴", "鸡", "狗", "猪"}; // 对应地支十二生肖
char *monthCn[] = {"正", "二", "三", "四", "五", "六", "七", "八", "九", "十", "十一", "腊"};
char *dateCn[]= {"初一", "初二", "初三", "初四", "初五", "初六", "初七", "初八", "初九", "初十", "十一", "十二", "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十", "廿一", "廿二", "廿三", "廿四", "廿五", "廿六", "廿七", "廿八", "廿九", "三十", "卅一"};

static char *heavenlyStems[] = {"甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸"}; // 天干
static char *earthlyBranches[] = {"子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥"}; // 地支

char *lunarFestivalName[] = {"春节", "元宵节", "龙抬头节", "端午节","七夕节", "中元节", "中秋节", "重阳节", "寒衣节", "下元节", "腊八节", "小年", "除夕"};
int lunarFestivalDate[] = {101, 115, 202, 505, 707, 715, 815, 909, 1001, 1015, 1208, 1223, 100};

char *solarFestivalName[] = {"元旦节","水瓶","湿地日-世界湿地日","*国际气象节","情人节","双鱼","*国际海豹日","*全国爱耳日","学雷锋纪念日","妇女节","植树节 孙中山逝世纪念日","*国际警察日","消费者-消费者权益日","*中国国医节 国际航海日","白羊 世界森林日 消除种族歧视国际日 世界儿歌日","*世界水日","*世界气象日","*世界防治结核病日","*全国中小学生安全教育日","*巴勒斯坦国土日","愚人节 全国爱国卫生运动月 税收宣传月","*世界卫生日","金牛","地球日-世界地球日","*世界图书和版权日","*亚非新闻工作者日","劳动节","青年节","*碘缺乏病防治日","*世界红十字日","护士节-国际护士节","*国际家庭日","*世界电信日","博物馆-国际博物馆日","*全国学生营养日","双子","*国际生物多样性日","*世界无烟日","儿童节-国际儿童节","环境日-世界环境日","*全国爱眼日","*防治荒漠化和干旱日","巨蟹","奥林匹克-国际奥林匹克日","*全国土地日","*国际禁毒日","建党节 香港回归纪念日 中共诞辰 世界建筑日","*国际体育记者日","*抗日战争纪念日","*世界人口日","狮子","*非洲妇女日","建军节","*中国男子节(爸爸节)","处女","抗日战争-抗日战争胜利纪念","*国际扫盲日 国际新闻工作者日","*毛泽东逝世纪念","教师节-中国教师节","*世界清洁地球日","*国际臭氧层保护日","*九一八事变纪念日","*国际爱牙日","天秤","*世界旅游日","*孔子诞辰","国庆节 世界音乐日 国际老人节","*国际和平与民主自由斗争日","*世界动物日","*老人节","*全国高血压日","*世界邮政日 万国邮联日","*辛亥革命纪念日 世界精神卫生日","*世界保健日 国际教师节","*世界标准日","*国际盲人节(白手杖节)","*世界粮食日","*世界消除贫困日","*世界传统医药日","天蝎 联合国日 世界发展信息日","万圣节 世界勤俭日","*十月社会主义革命纪念日","*中国记者日","*全国消防安全宣传教育日","*世界青年节","光棍节 国际科学与和平周(本日所属的一周)","*孙中山诞辰纪念日","*世界糖尿病日","*国际大学生节 世界学生节","*世界问候日 世界电视日","射手","*国际声援巴勒斯坦人民国际日","艾滋病-世界艾滋病日","*世界残疾人日","*国际经济和社会发展志愿人员日","*国际儿童电视日","*世界足球日","*世界人权日","*西安事变纪念日","*南京大屠杀纪念日","*澳门回归纪念","*国际篮球日","摩羯","平安夜","圣诞节","*毛泽东诞辰纪念"};
int solarFestivalDate[] = {101, 120, 202, 210, 214, 219, 301, 303, 305, 308, 312, 314, 315, 317, 321, 322, 323, 324, 325, 330, 401, 407, 420, 422, 423, 424, 501, 504, 505, 508, 512,515, 517, 518, 520, 521, 522, 531, 601, 605, 606, 617, 622, 623, 625, 626, 701, 702, 707, 711, 723, 730, 801, 808,823, 903, 908, 909, 910, 914, 916, 918, 920, 923, 927, 928, 1001, 1002, 1004, 1006, 1008, 1009, 1010, 1013,1014, 1015, 1016, 1017, 1022, 1024, 1031, 1107, 1108,1109, 1110,  1111, 1112, 1114, 1117, 1121, 1123, 1129, 1201, 1203, 1205, 1208, 1209,1210, 1212, 1213, 1220, 1221, 1222, 1224, 1225, 122};

char *weekFestvialName[] = { "*世界哮喘日", "母亲节-国际母亲节 救助贫困母亲日", "*全国助残日", "*国际牛奶日", "*中国文化遗产日", "父亲节", "*国际合作节", "*被奴役国家周",  "*国际和平日", "*全民国防教育日", "*国际聋人节 世界儿童日", "*世界海事日 世界心脏病日", "*国际住房日 世界建筑日 世界人居日", "*国际减灾日", "*世界视觉日", "感恩节", "*国际儿童电视广播日"};
int weekFestvialDate[] = {513,521,531,533,627,631,717,731,933,937,941,951,1012,1024,1025,1145,1221};

char *solarTerm[] = {"立春", "雨水", "惊蛰", "春分", "清明", "谷雨", "立夏", "小满", "芒种", "夏至", "小暑", "大暑", "立秋", "处暑", "白露", "秋分", "寒露", "霜降", "立冬", "小雪", "大雪", "冬至", "小寒", "大寒"};
//1890年-2100年的24节气
int solarTerms[][24] = {{204,218,305,320,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,621,707,722,807,823,907,922,1008,1023,1107,1122,1206,1221,106,120}, {203,218,305,320,404,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,621,707,722,807,823,907,922,1008,1023,1107,1122,1206,1221,106,120}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,405,420,505,521,606,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,306,321,406,421,506,522,607,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,307,322,406,421,507,522,607,622,708,724,809,824,909,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,107,121}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,306,321,406,421,506,522,606,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,307,322,406,421,507,522,607,622,708,724,809,824,909,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,107,121}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,306,321,406,421,506,522,606,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,307,322,406,421,507,522,607,622,708,724,809,824,909,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1122,1207,1222,107,121}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,923,1009,1024,1108,1123,1208,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,322,406,421,506,522,607,622,708,724,808,824,909,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,106,121}, {204,219,306,321,405,421,506,521,606,622,708,723,808,824,908,923,1009,1024,1108,1123,1208,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,220,306,322,406,421,506,522,607,622,708,724,808,824,909,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,622,708,723,808,824,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,306,321,406,421,506,522,607,622,708,724,808,824,909,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,622,708,723,808,824,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,306,321,406,421,506,522,607,622,708,724,808,824,909,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,306,321,406,421,506,522,607,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,306,321,406,421,506,522,606,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,306,321,406,421,506,522,606,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,306,321,406,421,506,522,606,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,306,321,405,420,505,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,923,1009,1024,1108,1123,1208,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,305,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,708,723,808,824,908,923,1009,1024,1108,1123,1208,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,724,808,824,908,924,1009,1024,1108,1123,1208,1223,106,121}, {205,220,305,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,708,723,808,824,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,220,305,320,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,305,320,405,420,505,521,606,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,305,320,405,420,505,521,606,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,924,1009,1024,1108,1123,1208,1222,106,121}, {205,219,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,505,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,522,606,622,708,723,808,824,908,923,1009,1024,1108,1123,1208,1222,106,121}, {205,219,305,320,404,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1123,1207,1222,106,120}, {204,219,306,321,405,421,506,521,606,622,708,723,808,824,908,923,1009,1024,1108,1123,1208,1222,106,120}, {205,219,305,320,404,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,306,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,106,120}, {204,219,306,321,405,420,506,521,606,622,708,723,808,824,908,923,1009,1024,1108,1123,1208,1222,106,120}, {204,219,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1222,106,121}, {204,219,305,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,824,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,106,121}, {204,219,305,320,405,420,505,521,606,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,106,121}, {204,218,305,320,405,420,505,521,606,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,106,121}, {204,218,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,106,121}, {204,218,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,106,121}, {204,218,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1009,1024,1108,1123,1207,1222,106,120}, {204,219,305,320,404,420,505,521,605,621,707,722,807,823,907,922,1008,1023,1107,1122,1207,1221,106,121}, {204,218,305,320,404,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1123,1207,1222,106,120}, {204,219,305,320,404,420,505,520,605,621,707,722,807,823,907,922,1008,1023,1107,1122,1207,1221,106,121}, {204,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,622,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,106,120}, {204,219,305,320,404,419,505,520,605,621,707,722,807,823,907,922,1008,1023,1107,1122,1207,1221,106,120}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1207,1221,106,120}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,219,305,320,405,420,505,521,606,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1024,1108,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,106,120}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,106,120}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,506,521,606,621,707,723,808,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,106,120}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,106,120}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,106,120}, {203,218,305,320,404,420,505,520,605,621,707,722,807,823,907,922,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,404,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1007,1023,1107,1122,1206,1221,106,120}, {203,218,305,320,404,419,505,520,605,621,707,722,807,823,907,922,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,306,321,405,420,505,521,606,621,707,723,807,823,908,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,620,706,722,807,822,907,922,1007,1023,1107,1121,1206,1221,106,120}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1207,1221,105,119}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,405,420,505,521,606,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,620,706,722,807,822,907,922,1007,1023,1107,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1207,1221,105,119}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,620,706,722,807,822,907,922,1007,1023,1107,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,105,119}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,219,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,620,706,722,807,822,907,922,1007,1022,1106,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,105,119}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,505,520,605,620,706,722,807,822,907,922,1007,1022,1106,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,105,119}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,504,520,605,620,706,722,806,822,907,922,1007,1022,1106,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,105,119}, {203,218,305,320,404,420,505,520,605,621,707,722,807,823,907,922,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,504,520,605,620,706,722,806,822,907,922,1007,1022,1106,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1007,1023,1107,1122,1206,1221,105,119}, {203,218,305,320,404,420,505,520,605,621,707,722,807,823,907,922,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,504,520,605,620,706,722,806,822,907,922,1007,1022,1106,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1007,1023,1107,1122,1206,1221,105,119}, {203,218,305,320,404,419,505,520,605,621,706,722,807,823,907,922,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,305,320,404,419,504,520,605,620,706,722,806,822,907,922,1007,1022,1106,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,620,706,722,807,822,907,922,1007,1023,1107,1121,1206,1221,105,119}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1207,1221,105,120}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,304,319,404,419,504,520,605,620,706,722,806,822,906,922,1007,1022,1106,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,620,706,722,807,822,907,922,1007,1023,1107,1121,1206,1221,104,119}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1207,1221,105,119}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}, {204,219,304,319,404,419,504,520,604,620,706,722,806,822,906,922,1007,1022,1106,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,620,706,722,807,822,907,922,1007,1023,1107,1121,1206,1221,104,119}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,105,119}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,219,304,319,404,419,504,520,604,620,706,722,806,822,906,922,1007,1022,1106,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,620,706,722,807,822,907,922,1007,1022,1106,1121,1206,1221,104,119}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,105,119}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,218,304,319,404,419,504,520,604,620,706,722,806,822,906,922,1007,1022,1106,1121,1206,1221,105,120}, {203,218,305,320,404,419,505,520,605,620,706,722,806,822,907,922,1007,1022,1106,1121,1206,1221,104,119}, {203,218,305,320,404,419,505,520,605,621,706,722,807,822,907,922,1008,1023,1107,1122,1206,1221,105,119}, {203,218,305,320,404,420,505,521,605,621,707,722,807,823,907,923,1008,1023,1107,1122,1207,1221,105,120}, {204,218,305,320,405,420,505,521,605,621,707,723,807,823,907,923,1008,1023,1107,1122,1207,1222,105,120}};

static const int minYear        = 1890;     // 最小年限

int getLunarFestival(int data){
    int len = sizeof(lunarFestivalDate)/sizeof(lunarFestivalDate[0]);
    return getNumIndex(data, lunarFestivalDate, len);
}

int getWeekFestival(int data){
    int len = sizeof(weekFestvialDate)/sizeof(weekFestvialDate[0]);
    return getNumIndex(data, weekFestvialDate, len);
}

int getSolarFestival(int data){
    int len = sizeof(solarFestivalDate)/sizeof(solarFestivalDate[0]);
    return getNumIndex(data, solarFestivalDate, len);
}

int getNumIndex(int num, int data[], int len){
    for (int i=0; i<len; ++i)
        if(num == data[i])
            return i;
    return -1;
}

/**
 *  判断是否处于农历新年
 *
 *  param _year  阳历年
 *  param _month 阳历月
 *  param _day   阳历日
 *
 *  return YES 表示处于农历新年
 */
int isNewLunarYear(int _year, int _month, int _day) {
    _month += 1;
    int *springFestivalDate = springFestival[_year - minYear];
    int springFestivalMonth = springFestivalDate[0];
    int springFestivalDay = springFestivalDate[1];
    
    if (_month > springFestivalMonth) {
        return true;
    } else if (_month == springFestivalMonth) {
        return (_day >= springFestivalDay);
    } else {
        return false;
    }
}

time_t convert(int year,int month,int day)
{
    struct tm info={0};
    info.tm_year=year;
    info.tm_mon=month;
    info.tm_mday=day;
    return mktime(&info);
}

/**
 *  两个公历日期之间的天数
 *
 *  param year   年
 *  param month  月
 *  param day    日
 *  param year1  年2
 *  param month1 月2
 *  param day1   日2
 *
 *  return 间隔天数
 */
int getDaysBetweenSolar(int year, int month, int day, int year1, int month1, int day1) {
    time_t time1 = convert(year, month, day);
    time_t time2 = convert(year1, month1, day1);
    int m3 = time2 - time1;
    return (int)((time2-time1)/24/3600);
};

/**
 *  获取农历年份一年的每月的天数及一年的总天数
 *
 *  param year 农历年
 *
 */
void getLunarYearDays(int year, int monthDays[], int *len) {
    int *yearData = lunarInfo[year - minYear];
    int leapMonth = yearData[0]; // 闰月
    int monthData = yearData[3];
    int monthDataArr[16];
    int tmp[16];
    
    int i = 0;
    while(monthData){
        tmp[i++] = monthData&0x1;
        monthData >>= 1;
    }
    
    for(i=16-1; i>=0; i--){
        monthDataArr[16-1-i] = tmp[i];
    }
    
    *len = leapMonth ? 13 : 12; // 该年有几个月
    
    for(i=0; i<*len; i++){
        monthDays[i] = monthDataArr[i]==0?29:30;
    }
}

/**
 *  通过间隔天数查找农历日期
 *
 *  param year    农历年
 *  param between 间隔天数
 param time    农历日期
 */
void getLunarDateByBetween(int year, int between, lunar *time) {
    int monthDays[13];
    memset(monthDays, 0, 13);
    int yearDays = 0;
    int tmp_len = 0;
    getLunarYearDays(year, monthDays, &tmp_len);
    
    int i = 0;
    for(;i<13;i++){
        yearDays += monthDays[i];
    }
    
    int end = between > 0 ? between : yearDays - abs(between);
    int tempDays = 0;
    int month = 0;
    for (i=0; i<13; i++) {
        tempDays += monthDays[i];
        if (tempDays > end) {
            month = i;
            tempDays = tempDays - monthDays[i];
            break;
        }
    }
    
    time->tm_year = year;
    time->tm_mon = month;
    time->tm_mday = end - tempDays + 1;
}

/**
 *  根据距离正月初一的天数计算农历日期
 *
 *  param time1  公历日期]
 *
 *  param time2 农历日期
 */
void getLunarByBetween(struct tm *time1, lunar *time2) {
    int *yearData = lunarInfo[time1->tm_year - minYear];
    int zenMonth = yearData[1];
    int zenDay = yearData[2];
    int between = getDaysBetweenSolar(time1->tm_year, zenMonth - 1, zenDay, time1->tm_year, time1->tm_mon, time1->tm_mday);
    if (between == 0) { //正月初一
        time2->tm_year = time1->tm_year;
        time2->tm_mon = 0;
        time2->tm_mday = 1;
    } else {
        int lunarYear = (between > 0) ? (time1->tm_year) : (time1->tm_year - 1);
        getLunarDateByBetween(lunarYear, between, time2);
    }
}

int getWeek(struct tm *time){
    int year = time->tm_year;
    int month = time->tm_mon+1;
    if(month==1 || month==2){
        month += 12;
        year --;
    }
    
    return (time->tm_mday+2*month+3*(month+1)/5+year+year/4-year/100+year/400)%7;
}

/**
 公历转农历
 */
void solar2lunar(calendar *cal){
    // 干支所在年份
    int ganZhiYear = isNewLunarYear(cal->solar.tm_year, cal->solar.tm_mon, cal->solar.tm_mday) ? (cal->solar.tm_year + 1) : (cal->solar.tm_year);
    
    //转换公历/农历
    getLunarByBetween(&cal->solar, &cal->lun);
    
    int lunarLeapMonth = lunarInfo[cal->lun.tm_year - minYear][0];
    
    // 获取农历 月
    int lunarMonthIndex = -1;
    if (lunarLeapMonth > 0 && lunarLeapMonth == cal->lun.tm_mon) {
        lunarMonthIndex = cal->lun.tm_mon - 1;
    } else if(lunarLeapMonth > 0 && cal->lun.tm_mon > lunarLeapMonth) {
        lunarMonthIndex = cal->lun.tm_mon - 1;
    } else {
        lunarMonthIndex = cal->lun.tm_mon;
    }
    sprintf(cal->lunarMonthName, "%s月", monthCn[lunarMonthIndex-1]);
    //    printf("%s月\n", monthCn[lunarMonthIndex]);
    
    //获取农历日期
    //    printf("农历日期==>%s\n", dateCn[cal->lun.tm_mday - 1]);
    strcpy(cal->lunarDayName, dateCn[cal->lun.tm_mday - 1]);
    
}


/**
 公历转农历 带节日
 */
void solar2lunarInfo(calendar *cal){
    // 干支所在年份
    int ganZhiYear = isNewLunarYear(cal->solar.tm_year, cal->solar.tm_mon, cal->solar.tm_mday) ? (cal->solar.tm_year + 1) : (cal->solar.tm_year);
    
    //转换公历/农历
    getLunarByBetween(&cal->solar, &cal->lun);
    
    int lunarLeapMonth = lunarInfo[cal->lun.tm_year - minYear][0];
    
    // 获取农历 月
    int lunarMonthIndex = -1;
    if (lunarLeapMonth > 0 && lunarLeapMonth == cal->lun.tm_mon) {
        lunarMonthIndex = cal->lun.tm_mon - 1;
    } else if(lunarLeapMonth > 0 && cal->lun.tm_mon > lunarLeapMonth) {
        lunarMonthIndex = cal->lun.tm_mon - 1;
    } else {
        lunarMonthIndex = cal->lun.tm_mon;
    }
    sprintf(cal->lunarMonthName, "%s月", monthCn[lunarMonthIndex-1]);
    //    printf("%s月\n", monthCn[lunarMonthIndex]);
    
    //获取农历日期
    //    printf("农历日期==>%s\n", dateCn[cal->lun.tm_mday - 1]);
    strcpy(cal->lunarDayName, dateCn[cal->lun.tm_mday - 1]);
    
    
    
    int lunarMonthDays[13];
    int monthLen = 0;
    getLunarYearDays(cal->lun.tm_year, lunarMonthDays, &monthLen);
    
    // 农历节日判断
    // 除夕
    int lunarIndex = -1;
    if ((cal->lun.tm_mon == monthLen - 1) &&
        (cal->lun.tm_mday == lunarMonthDays[monthLen - 1])) {
        lunarIndex = getLunarFestival(100);
    } else if (lunarLeapMonth > 0 && cal->lun.tm_mon >= lunarLeapMonth) {
        int date = cal->lun.tm_mon*100 + cal->lun.tm_mday;
        lunarIndex = getLunarFestival(date);
    } else {
        int date = (cal->lun.tm_mon+1)*100 + cal->lun.tm_mday;
        lunarIndex = getLunarFestival(date);
    }
    if(lunarIndex != -1) {
        //        printf("农历节日==>%s\n", lunarFestivalName[lunarIndex]);
        strcpy(cal->lunarFestival, lunarFestivalName[lunarIndex]);
    }
    
    //获取公历节日
    int date = (cal->solar.tm_mon+1)*100 + cal->solar.tm_mday;
    int index = getSolarFestival(date);
    if(index != -1){
        strcpy(cal->solarFestival, solarFestivalName[index]);
        //        printf("公历节日==>%s\n", solarFestivalName[index]);
    }
    
    //获取周节日
    int week = getWeek(&cal->solar);
    int weekCout = ceil(cal->solar.tm_mday/7.0);
    int weekIndex = getWeekFestival(cal->solar.tm_mon*100 + weekCout*10 + week);
    if(weekIndex != -1){
        strcpy(cal->weekFestival, weekFestvialName[weekIndex]);
        //        printf("周节日==>%s\n", weekFestvialName[weekIndex]);
    }
    
    //节气判断
    int md = (cal->solar.tm_mon+1)*100 + cal->solar.tm_mday;
    int yearIndex = cal->solar.tm_year-1890;
    //    int liChun = md < solarTerms[yearIndex][0]?1:0;//判断是否立春 0 立春之后 1 立春之前
    
    for (int i=0; i<24; i++) {
        if(solarTerms[yearIndex][i]==md){
            strcpy(cal->term, solarTerm[i]);
            break;
        }
    }
    
    int gzYear = ganZhiYear - 1890 + 25;
    //    gzYear -=  liChun;
    sprintf(cal->GanZhiYear, "%s%s年", heavenlyStems[gzYear%10], earthlyBranches[gzYear%12]);
    //    printf("干支年==>%s%s年\n", heavenlyStems[gzYear%10], earthlyBranches[gzYear%12]);
    
    strcpy(cal->zodiac, zodiac[gzYear%12]);
    //    printf("生肖==>%s\n", zodiac[gzYear%12]);
}
